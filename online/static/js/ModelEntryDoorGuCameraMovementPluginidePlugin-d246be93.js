import{R as c,w as g}from"./mockData-2a386b6f.js";import{as as N,at as E,F as M,r as O,a as R,j as m,B as D,a8 as B,d as L,au as U,av as w,c as W,e as z,R as j}from"./vendor-862c62a4.js";const k=window.requestAnimationFrame||(e=>setTimeout(e,16)),q=window.cancelAnimationFrame||clearTimeout;function _(e,n=0){n<=0?k(e):k(()=>_(e,n-1))}function K(e,n=60){let a=-1,u=0,i=-1;const t=1e3/n;function r(o){i===-1&&(i=o),a=k(r),!(o-u<t)&&(u=o,e&&e(o-i))}return a=k(r),function(){q(a)}}const V=E;function $(e,n,a,u=V.Linear.None){const i=new N(e).to(n,a).easing(u);_(()=>i.start(0));const t=K(o=>{i.update(o)===!1&&t()}),r=[];return i.onDestroy=o=>(r.push(o),i),i.destroy=function(){this.stop(),Object.assign(i,{_onStartCallback:null,_onUpdateCallback:null,_onCompleteCallback:null,_onStopCallbackL:null});let o;for(;o=r.shift();)o();t()},i}function G(e,n){return $({progress:0},{progress:1},e,n)}const I=Math.PI*2;function y(e){return(e%I+I)%I}function F(e){return e%I}function b(e,n,a){return e+(n-e)*a}const h=(e,n,a)=>{const u=Math.PI,i=u*2;return e=y(e),n=y(n),a===c.Anticlockwise&&e<n&&(e+=i),a===c.Clockwise&&n<e&&(n+=i),a===c.Loop&&n-e>u?h(e,n,c.Anticlockwise):a===c.Loop&&e-n>u?h(e,n,c.Clockwise):{from:e,to:n}},H=e=>{const n={},a=async(t,r,o={preload:!0})=>(n.interruptCallback&&n.interruptCallback(!1),o.asyncStartCallback&&await o.asyncStartCallback(),t.mode&&t.mode!==e.currentMode&&await e.changeMode(t.mode),o.preload&&t.panoIndex!==void 0&&t.panoIndex!==e.panoIndex&&await e.preloadPano(t.panoIndex),o.asyncEndCallback&&await o.asyncEndCallback(),t.panoIndex===void 0&&t.fov===void 0&&t.latitude===void 0&&t.longitude===void 0?!0:await new Promise((d,s)=>{const l=t.panoIndex!==void 0?t.panoIndex:e.panoIndex;l!==void 0?e.moveToPano(l,Object.assign({duration:r,moveEndCallback:()=>d(!0),moveCancelCallback:()=>s(!1)},t)):s(!1)})),u=t=>{const r=e.state,o=F(r.latitude),d=F(t.latitude),{from:s,to:l}=h(r.longitude,t.longitude,t.rotation||c.Loop),f=r.fov,P=t.fov;return{from:{latitude:o,longitude:s,fov:f},to:{latitude:d,longitude:l,fov:P}}};return{move:a,rotate:async(t,r,o={})=>{n.interruptCallback&&n.interruptCallback(!1),o.asyncStartCallback&&await o.asyncStartCallback(),e.currentMode!==M.Mode.Panorama&&await e.changeMode(M.Mode.Panorama),t.panoIndex!==void 0&&t.panoIndex!==e.panoIndex&&(o.preload&&await e.preloadPano(t.panoIndex),await new Promise((l,f)=>{if(!t.panoIndex){l(!0);return}e.moveToPano(t.panoIndex,{moveEndCallback:()=>l(!0),moveCancelCallback:()=>f(!1)})})),o.asyncEndCallback&&await o.asyncEndCallback();const{from:d,to:s}=u(t);return await new Promise(l=>{const f=({progress:p})=>{const C={};C.longitude=b(d.longitude,s.longitude,p),C.latitude=b(d.latitude,s.latitude,p),C.fov=b(d.fov,s.fov,p),e.setState(C,!0)},P=()=>{l(!0)},A=()=>{l(!1)},S=t.rotateSpeed?Math.ceil(Math.abs(s.longitude-d.longitude)/t.rotateSpeed*1e3):r,x=G(S,E.Linear.None).onUpdate(f).onComplete(P).onDestroy(A);t.rotation===c.Loop&&x.repeat(1/0).yoyo(!0),n.interruptCallback=(p=!0)=>{x.destroy(),n.interruptCallback=void 0,n.timeoutId&&(clearTimeout(n.timeoutId),n.timeoutId=void 0),l(p)},n.timeoutId=setTimeout(()=>{n.interruptCallback&&n.interruptCallback(!0)},r)})}}};function T(){return{width:window.innerWidth,height:window.innerHeight}}function J(){const[e,n]=O.exports.useState(T);return O.exports.useEffect(()=>{const a=()=>n(T());return window.addEventListener("resize",a,!1),()=>window.removeEventListener("resize",a,!1)}),e}const v={PANO_MOVE:{fov:98,panoIndex:1,latitude:-.007769878726327784,longitude:4.614049904222785},CLOCKWISE_ROTATION:{fov:50,latitude:.0340522133938706,longitude:.1257016521296519,rotation:c.Anticlockwise},COUNTERCLOCKWISE_ROTATION:{fov:50,latitude:.0340522133938706,longitude:.1257016521296519,rotation:c.Clockwise},ROUND:{fov:50,latitude:-.0004827098383655415,longitude:1.264471004436043,rotateSpeed:.25,rotation:c.Loop}},Q=e=>{const n=R(),a=(i,t=1e4)=>{n.plugins.cameraMovementPlugin.move(i,t)},u=(i,t=1e4)=>{n.plugins.cameraMovementPlugin.rotate(i,t)};return m(D,{children:m(B,{sx:{position:"fixed",top:"10px",right:"10px",backgroundColor:"transparent"},children:L(U,{size:"large","aria-label":"large button group",orientation:"vertical",children:[m(w,{onClick:()=>a(v.PANO_MOVE),children:"\u70B9\u4F4D\u6E38\u8D70"}),m(w,{onClick:()=>u(v.CLOCKWISE_ROTATION),children:"\u987A\u65F6\u9488\u65CB\u8F6C"}),m(w,{onClick:()=>u(v.COUNTERCLOCKWISE_ROTATION),children:"\u9006\u65F6\u9488\u65CB\u8F6C"}),m(w,{onClick:()=>u(v.ROUND,2e4),children:"\u6765\u56DE\u65CB\u8F6C"})]})})})},X=W({onlyRenderIfNeeds:!0,plugins:[[H,"cameraMovementPlugin",{}]]}),Y=()=>{const e=J();return g&&L(X,{initialWork:g,ref:n=>Object.assign(window,{$five:n?.five}),children:[m(z,{...e}),m(Q,{})]})};j.render(m(Y,{}),document.querySelector("#app"));
