import{n as T,r as A}from"./BetterTween-b9d741f5.js";import{at as N,au as L,F as x,r as g,a as R,j as s,B as D,a9 as B,d as F,av as U,aw as w,c as W,e as z,R as j}from"./vendor-5f3df8df.js";import{R as d}from"./typing-9caf697c.js";import{w as M}from"./mockData-a850cee4.js";const K=L;function q(e,n,a,u=K.Linear.None){const i=new N(e).to(n,a).easing(u);T(()=>i.start(0));const t=A(o=>{i.update(o)===!1&&t()}),r=[];return i.onDestroy=o=>(r.push(o),i),i.destroy=function(){this.stop(),Object.assign(i,{_onStartCallback:null,_onUpdateCallback:null,_onCompleteCallback:null,_onStopCallbackL:null});let o;for(;o=r.shift();)o();t()},i}function V(e,n){return q({progress:0},{progress:1},e,n)}const v=Math.PI*2;function O(e){return(e%v+v)%v}function y(e){return e%v}function P(e,n,a){return e+(n-e)*a}const b=(e,n,a)=>{const u=Math.PI,i=u*2;return e=O(e),n=O(n),a===d.Anticlockwise&&e<n&&(e+=i),a===d.Clockwise&&n<e&&(n+=i),a===d.Loop&&n-e>u?b(e,n,d.Anticlockwise):a===d.Loop&&e-n>u?b(e,n,d.Clockwise):{from:e,to:n}},$=e=>{const n={},a=async(t,r,o={preload:!0})=>(n.interruptCallback&&n.interruptCallback(!1),o.asyncStartCallback&&await o.asyncStartCallback(),t.mode&&t.mode!==e.currentMode&&await e.changeMode(t.mode),o.preload&&t.panoIndex!==void 0&&t.panoIndex!==e.panoIndex&&await e.preloadPano(t.panoIndex),o.asyncEndCallback&&await o.asyncEndCallback(),t.panoIndex===void 0&&t.fov===void 0&&t.latitude===void 0&&t.longitude===void 0?!0:await new Promise((m,c)=>{const l=t.panoIndex!==void 0?t.panoIndex:e.panoIndex;l!==void 0?e.moveToPano(l,Object.assign({duration:r,moveEndCallback:()=>m(!0),moveCancelCallback:()=>c(!1)},t)):c(!1)})),u=t=>{const r=e.state,o=y(r.latitude),m=y(t.latitude),{from:c,to:l}=b(r.longitude,t.longitude,t.rotation||d.Loop),p=r.fov,I=t.fov;return{from:{latitude:o,longitude:c,fov:p},to:{latitude:m,longitude:l,fov:I}}};return{move:a,rotate:async(t,r,o={})=>{n.interruptCallback&&n.interruptCallback(!1),o.asyncStartCallback&&await o.asyncStartCallback(),e.currentMode!==x.Mode.Panorama&&await e.changeMode(x.Mode.Panorama),t.panoIndex!==void 0&&t.panoIndex!==e.panoIndex&&(o.preload&&await e.preloadPano(t.panoIndex),await new Promise((l,p)=>{if(!t.panoIndex){l(!0);return}e.moveToPano(t.panoIndex,{moveEndCallback:()=>l(!0),moveCancelCallback:()=>p(!1)})})),o.asyncEndCallback&&await o.asyncEndCallback();const{from:m,to:c}=u(t);return await new Promise(l=>{const p=({progress:f})=>{const C={};C.longitude=P(m.longitude,c.longitude,f),C.latitude=P(m.latitude,c.latitude,f),C.fov=P(m.fov,c.fov,f),e.setState(C,!0)},I=()=>{l(!0)},S=()=>{l(!1)},_=t.rotateSpeed?Math.ceil(Math.abs(c.longitude-m.longitude)/t.rotateSpeed*1e3):r,h=V(_,L.Linear.None).onUpdate(p).onComplete(I).onDestroy(S);t.rotation===d.Loop&&h.repeat(1/0).yoyo(!0),n.interruptCallback=(f=!0)=>{h.destroy(),n.interruptCallback=void 0,n.timeoutId&&(clearTimeout(n.timeoutId),n.timeoutId=void 0),l(f)},n.timeoutId=setTimeout(()=>{n.interruptCallback&&n.interruptCallback(!0)},r)})}}};function E(){return{width:window.innerWidth,height:window.innerHeight}}function G(){const[e,n]=g.exports.useState(E);return g.exports.useEffect(()=>{const a=()=>n(E());return window.addEventListener("resize",a,!1),()=>window.removeEventListener("resize",a,!1)}),e}const k={PANO_MOVE:{fov:98,panoIndex:1,latitude:-.007769878726327784,longitude:4.614049904222785},CLOCKWISE_ROTATION:{fov:50,latitude:.0340522133938706,longitude:.1257016521296519,rotation:d.Anticlockwise},COUNTERCLOCKWISE_ROTATION:{fov:50,latitude:.0340522133938706,longitude:.1257016521296519,rotation:d.Clockwise},ROUND:{fov:50,latitude:-.0004827098383655415,longitude:1.264471004436043,rotateSpeed:.25,rotation:d.Loop}},H=e=>{const n=R(),a=(i,t=1e4)=>{n.plugins.cameraMovementPlugin.move(i,t)},u=(i,t=1e4)=>{n.plugins.cameraMovementPlugin.rotate(i,t)};return s(D,{children:s(B,{sx:{position:"fixed",top:"10px",right:"10px",backgroundColor:"transparent"},children:F(U,{size:"large","aria-label":"large button group",orientation:"vertical",children:[s(w,{onClick:()=>a(k.PANO_MOVE),children:"\u70B9\u4F4D\u6E38\u8D70"}),s(w,{onClick:()=>u(k.CLOCKWISE_ROTATION),children:"\u987A\u65F6\u9488\u65CB\u8F6C"}),s(w,{onClick:()=>u(k.COUNTERCLOCKWISE_ROTATION),children:"\u9006\u65F6\u9488\u65CB\u8F6C"}),s(w,{onClick:()=>u(k.ROUND,2e4),children:"\u6765\u56DE\u65CB\u8F6C"})]})})})},J=W({onlyRenderIfNeeds:!0,plugins:[[$,"cameraMovementPlugin",{}]]}),Q=()=>{const e=G();return M&&F(J,{initialWork:M,ref:n=>Object.assign(window,{$five:n?.five}),children:[s(z,{...e}),s(H,{})]})};j.render(s(Q,{}),document.querySelector("#app"));
