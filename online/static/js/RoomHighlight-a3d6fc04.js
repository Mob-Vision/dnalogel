import{g as y,i as _,h as w,k as b,Z as H,l as g,n as d,q as p,t as x,x as S,o as L,_ as O,Q,K as P,U as J,J as h,E as C,H as G,L as R,$ as K,N as F,I as Z,X as V,Y as X,a0 as $,y as ee,a1 as ne,C as oe,a2 as I,a3 as te}from"./vendor-5f3df8df.js";import"./typing-9caf697c.js";const re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAwCAYAAACFUvPfAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAALaADAAQAAAABAAAAMAAAAADe2FZjAAAEF0lEQVRoBe2WzWskRRiHf13V092TxI2oEzYeVDwITtyDuCiihwiCePGgxIM3vYgHL4J4UIhBRA8i/gPqyUvWg7AiIuIeloDiYUHJLOK6BPwIk9nNODM9Xf1RVe1b3elJRjCZmQ6euqGmuqer33rq4e23GqiOykBloDJQGagMVAYqA5WBykBlYFYD1qwP/tdzaZqOx9zYOLxeX0+L5yzLGp0X/03a25MOnGRcBtx+6Rlo9SL08G4EooFnxa8Yiivox5/h5Ys/4cl7NVorNDRnngX+0MIkVMeMSf23zyKML8J7/Dy8hwF2Buh9CnS+AEQIdLspBuGb+M7/qLW4qJrNpsLapjYhpwVnx3BMfCtNNx3Etc9xywvnMf80wG8HmQainw0RxSGrnmeBp+8k5/j9S0HbvXb5io0Lz880/0wPHV1NlhLd316He+4xOCv5ragF7L9PrH1qBJyB0626x/lC+qrSvH5r/W+n1WpxUM5nMY4GPeH8lHJaPgfeAFQHCL+ntkXT+vnUc3W6pvTIwC0wy3rA4dwLmK2avZ7Eo9uKBuYJfgJscbs8dLCxDMt+EOEPBEZNEWyBYHqTz6bPXrzUnNrSShxHIsYiOL69zrCGLLcLqJP68tB+9w5wj+YhWDafQ2s61wNqxjZhmrQ2pvMFCEvXuCUZ7wqH794ZWs28LJqlTXSUyuksF2M/yOwqgkx2c1ADa4wLAQRk2sAGQQakhN6yFC2hltfz5kSY44NKQeeh+vtI/SSzWhg2CzCgmWISmKUGmaYFBDfCSymnfxJ6/+ospVcWOLLp5DGP/y0P/Rp66O99DQNq7Po3Ds0a0wY+My2QSv2N2mO/OyxR2o6UQk+Lv7yJ06JYSnnolZVU9cUn2O9SmaMWGFBqYXRwbqAJWIi94TX5biotpcGl1DXZ6LnqIbNDTnmUgi52Mv5l5ysMxIcZcGjy2DTK4ZHlcBC14zeSge4qphICjj3bS0A7o9nSp2TOkm7aZ8bGZy/jxhO87V91G0+dfY/Z7BWIIK9KYUi5qy/Hf8YfBG3sqJTHiQWhmTVkbip+wX3x6volVSx+LPAxF+VLXhZ8VQ+iP2Rta/iWe5v42Fngj0BbdnRTXh12ZIcKhTaGbcYjybRwXBU1lu9KlndXp04NM52poKWO0RZsviNaP9a6grkO972+st05pXhE5c1hTEluJy7XUejGUQNLMbAmTdWY1rKBLW3aTJqBZ7nZkb36DhYCreeYHbMUXHvaYi5XDK70EcgulmRjm77wNtenzuXCbmnTRaAx493rbGf3Jr/njMzj920CnKdUaFCjlDioy7NYNvOdGrQJNgI32/L2tkXfFPlxgToqjWVhD6KdLnQRdARf/HHQz2r2X2Gqy8pAZaAyUBmoDFQGKgP/q4F/AJYg9/s0ZoABAAAAAElFTkSuQmCC";function ie(t,e={}){let o="";const{needZ:n,needA:r}=e;return(n?t.slice().concat(t[0]):t.slice()).forEach((f,l)=>{const{x:s,y:a}=e.format?e.format(f):f,A=s+","+a;return l===0?(o+="M"+A,o):r?.[l]?(o+="A"+r[l]+","+A,o):(o+="L"+A,o)}),o+(n?"Z":"")}function le({x:t,y:e},o,n){const{max:r,min:i}=n;return{x:(t-i.x)*o,y:(r.y-e)*o}}function se(t,e){const o=t.x*1e3+e.bounding.origin.x,n=-t.z*1e3+e.bounding.origin.y;return{x:o,y:n}}function fe(t,e){const o=e.bounding,n=o.max.x-o.min.x,r=o.max.y-o.min.y;return{x:(t.x-o.min.x)/n,y:(o.max.y-t.y)/r}}function ae(t,e){return Math.max(...e.work.observers.map(n=>t.z>=n.standingPosition.z?n.floorIndex:0))}async function ce(t){const e=new Headers({"Content-Type":"text/plain"}),o=async function(r){const i={index:r.index,url:r.url,svgUrl:r.svg_url};if(r.svg_url){const f=await fetch(r.svg_url,{headers:e}).then(l=>l.text());i.svgContent=f}return i};return await Promise.all(t.map(o))}function ue(t){return{id:t.id,size:t.size,name:t.name,path:t.path,roomType:t.room_type,floorType:t.floor_type,roomLabel:{position:t.room_label.position,positionInImage:t.room_label.position_in_image},observerIndexs:t.observer_indexs}}function me(t){return{floorName:t.floor_name,floorIndex:t.floor_index,rooms:t.rooms.map(ue),rules:t.rules}}function Ae(t){return{index:t.index,floorIndex:t.floor_index,position:t.position,positionInImage:t.position_in_image}}function ge(t){return{rad:t.rad,position:t.position,positionInImage:t.position_in_image,northRad:t.north_rad,roomId:t.room_id,floorIndex:t.floor_index}}async function Me(t){const e=await ce(t.outlines),o=t.computed_data.bounding,n=t.computed_data.floor_datas.map(me),r=t.computed_data.entrance?ge(t.computed_data.entrance):null;return{outlines:e,entrance:r,bounding:o,floorDatas:n,observers:t.computed_data.observers.map(Ae)}}function Be(t,e,o){return t.map(r=>{const i=r.position,f=r.icon?r.icon:{url:re,width:45,height:48},l=ae(i,e),s=se(i,o),a=fe(s,o);return{floorIndex:l,icon:f,id:r.id,position:s,positionInImage:a}})}const He="data:image/png;base64,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";function ve(t){let e,o;return{c(){e=b("img"),H(e.src,o=t[0])||g(e,"src",o),g(e,"alt","floorplan iamge"),g(e,"class","svelte-1cuuebb")},m(n,r){d(n,e,r)},p(n,[r]){r&1&&!H(e.src,o=n[0])&&g(e,"src",o)},i:p,o:p,d(n){n&&x(e)}}}function pe(t,e,o){let{url:n}=e;return t.$$set=r=>{"url"in r&&o(0,n=r.url)},[n]}class Pe extends y{constructor(e){super();_(this,e,pe,ve,w,{url:0})}}function he(t){let e,o,n,r;return{c(){e=b("div"),o=new O,n=S(),r=new O,o.a=n,r.a=null,g(e,"class","floorplan-plugin__base-image svelte-1qqy56u")},m(i,f){d(i,e,f),o.m(t[1],e),L(e,n),r.m(t[0],e)},p(i,[f]){f&1&&r.p(i[0])},i:p,o:p,d(i){i&&x(e)}}}function de(t,e,o){let{content:n}=e;const r=`
    <style>
      svg [type='lineGroup'] path {
        fill: #ffffff;
        stroke: #ffffff;
      }
      svg [type='lineItemGroup'] g g g g {
        stroke: #ffffff;
      }
    </style>
  `;return t.$$set=i=>{"content"in i&&o(0,n=i.content)},[n,r]}class xe extends y{constructor(e){super();_(this,e,de,he,w,{content:0})}}function Ie(t){let e,o;return e=new Pe({props:{url:t[1].url}}),{c(){C(e.$$.fragment)},m(n,r){G(e,n,r),o=!0},p(n,r){const i={};r&2&&(i.url=n[1].url),e.$set(i)},i(n){o||(h(e.$$.fragment,n),o=!0)},o(n){P(e.$$.fragment,n),o=!1},d(n){R(e,n)}}}function ye(t){let e,o;return e=new xe({props:{content:t[0]}}),{c(){C(e.$$.fragment)},m(n,r){G(e,n,r),o=!0},p(n,r){const i={};r&1&&(i.content=n[0]),e.$set(i)},i(n){o||(h(e.$$.fragment,n),o=!0)},o(n){P(e.$$.fragment,n),o=!1},d(n){R(e,n)}}}function _e(t){let e,o,n,r;const i=[ye,Ie],f=[];function l(s,a){return s[0]?0:s[1]?1:-1}return~(o=l(t))&&(n=f[o]=i[o](t)),{c(){e=b("div"),n&&n.c(),g(e,"class","floorplan-plugin__base-image svelte-126ja8e")},m(s,a){d(s,e,a),~o&&f[o].m(e,null),r=!0},p(s,[a]){let A=o;o=l(s),o===A?~o&&f[o].p(s,a):(n&&(Q(),P(f[A],1,1,()=>{f[A]=null}),J()),~o?(n=f[o],n?n.p(s,a):(n=f[o]=i[o](s),n.c()),h(n,1),n.m(e,null)):n=null)},i(s){r||(h(n),r=!0)},o(s){P(n),r=!1},d(s){s&&x(e),~o&&f[o].d()}}}function we(t,e,o){let n,r,{floorIndex:i}=e,{floorplanData:f}=e;return t.$$set=l=>{"floorIndex"in l&&o(2,i=l.floorIndex),"floorplanData"in l&&o(3,f=l.floorplanData)},t.$$.update=()=>{t.$$.dirty&12&&o(1,n=f.outlines[i]),t.$$.dirty&12&&o(0,r=f.outlines?.[i]?.svgContent)},[r,n,i,f]}class Oe extends y{constructor(e){super();_(this,e,we,_e,w,{floorIndex:2,floorplanData:3})}}function De(t){let e;return{c(){e=K("path"),g(e,"d",t[0]),g(e,"fill","#fff"),g(e,"class","svelte-11takew")},m(o,n){d(o,e,n)},p,i:p,o:p,d(o){o&&x(e)}}}function be(t,e,o){let{pxmm:n}=e,{room:r}=e,{floorplanData:i}=e;const{bounding:f}=i,l=ie(r.path,{needZ:!0,format:s=>le(s,n,f)});return t.$$set=s=>{"pxmm"in s&&o(1,n=s.pxmm),"room"in s&&o(2,r=s.room),"floorplanData"in s&&o(3,i=s.floorplanData)},[l,n,r,i]}class Ce extends y{constructor(e){super();_(this,e,be,De,w,{pxmm:1,room:2,floorplanData:3})}}function N(t,e,o){const n=t.slice();return n[12]=e[o],n}function E(t,e){let o,n,r;const i=[{room:e[12],floorplanData:e[2],pxmm:e[0]}];let f={};for(let l=0;l<i.length;l+=1)f=oe(f,i[l]);return n=new Ce({props:f}),{key:t,first:null,c(){o=F(),C(n.$$.fragment),this.first=o},m(l,s){d(l,o,s),G(n,l,s),r=!0},p(l,s){e=l;const a=s&7?Z(i,[{room:e[12],floorplanData:e[2],pxmm:e[0]}]):{};n.$set(a)},i(l){r||(h(n.$$.fragment,l),r=!0)},o(l){P(n.$$.fragment,l),r=!1},d(l){l&&x(o),R(n,l)}}}function Ge(t){let e,o,n=[],r=new Map,i,f,l,s,a=t[2].floorDatas[t[1]].rooms;const A=c=>c[12].id;for(let c=0;c<a.length;c+=1){let u=N(t,a,c),v=A(u);r.set(v,n[c]=E(v,u))}return{c(){e=b("div"),o=K("svg");for(let c=0;c<n.length;c+=1)n[c].c();g(o,"class","svelte-1aais5l"),g(e,"class","floorplan-plugin__room-highlight svelte-1aais5l"),V(()=>t[10].call(e))},m(c,u){d(c,e,u),L(e,o);for(let v=0;v<n.length;v+=1)n[v].m(o,null);t[9](e),i=X(e,t[10].bind(e)),f=!0,l||(s=$(e,"click",t[6]),l=!0)},p(c,[u]){u&7&&(a=c[2].floorDatas[c[1]].rooms,Q(),n=ee(n,u,A,1,c,a,r,o,ne,E,null,N),J())},i(c){if(!f){for(let u=0;u<a.length;u+=1)h(n[u]);f=!0}},o(c){for(let u=0;u<n.length;u+=1)P(n[u]);f=!1},d(c){c&&x(e);for(let u=0;u<n.length;u+=1)n[u].d();t[9](null),i(),l=!1,s()}}}function Re(t,e,o){let{five:n}=e,{pxmm:r}=e,{floorIndex:i}=e,{floorplanData:f}=e,{onRoomHeightClick:l}=e,s,a,A;const{observers:c}=f,u=function(m){if(l?.(m)===!1)return;const k=A.getBoundingClientRect(),Y=new I(m.clientX,m.clientY),z=new I(k.left,k.top),q=Y.clone().sub(z),M=new I(q.x/s,q.y/a),T=c.filter(D=>D.floorIndex===i).sort((D,B)=>{const W=new I(D.positionInImage.x,D.positionInImage.y),j=new I(B.positionInImage.x,B.positionInImage.y);return W.distanceTo(M)-j.distanceTo(M)})[0];n.moveToPano(T.index)};function v(m){te[m?"unshift":"push"](()=>{A=m,o(5,A)})}function U(){s=this.clientWidth,a=this.clientHeight,o(3,s),o(4,a)}return t.$$set=m=>{"five"in m&&o(7,n=m.five),"pxmm"in m&&o(0,r=m.pxmm),"floorIndex"in m&&o(1,i=m.floorIndex),"floorplanData"in m&&o(2,f=m.floorplanData),"onRoomHeightClick"in m&&o(8,l=m.onRoomHeightClick)},[r,i,f,s,a,A,u,n,l,v,U]}class Ne extends y{constructor(e){super();_(this,e,Re,Ge,w,{five:7,pxmm:0,floorIndex:1,floorplanData:2,onRoomHeightClick:8})}}export{Oe as B,He as C,Ne as R,Be as a,le as b,Me as f,ie as p};
