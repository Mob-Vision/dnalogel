import{n as T,r as A,w as x}from"./mockData-390f2e53.js";import{au as N,av as L,F as g,r as M,a as R,j as s,B as D,aa as B,d as F,aw as U,ax as w,c as W,e as z,R as j}from"./vendor-6e04d41e.js";import{R as d}from"./typing-9caf697c.js";import"./loadTexture-b2c90048.js";import"./constants-6d6c99de.js";const K=L;function q(e,n,o,u=K.Linear.None){const i=new N(e).to(n,o).easing(u);T(()=>i.start(0));const t=A(a=>{i.update(a)===!1&&t()}),r=[];return i.onDestroy=a=>(r.push(a),i),i.destroy=function(){this.stop(),Object.assign(i,{_onStartCallback:null,_onUpdateCallback:null,_onCompleteCallback:null,_onStopCallbackL:null});let a;for(;a=r.shift();)a();t()},i}function V(e,n){return q({progress:0},{progress:1},e,n)}const v=Math.PI*2;function O(e){return(e%v+v)%v}function y(e){return e%v}function P(e,n,o){return e+(n-e)*o}const b=(e,n,o)=>{const u=Math.PI,i=u*2;return e=O(e),n=O(n),o===d.Anticlockwise&&e<n&&(e+=i),o===d.Clockwise&&n<e&&(n+=i),o===d.Loop&&n-e>u?b(e,n,d.Anticlockwise):o===d.Loop&&e-n>u?b(e,n,d.Clockwise):{from:e,to:n}},$=e=>{const n={},o=async(t,r,a={preload:!0})=>(n.interruptCallback&&n.interruptCallback(!1),a.asyncStartCallback&&await a.asyncStartCallback(),t.mode&&t.mode!==e.currentMode&&await e.changeMode(t.mode),a.preload&&t.panoIndex!==void 0&&t.panoIndex!==e.panoIndex&&await e.preloadPano(t.panoIndex),a.asyncEndCallback&&await a.asyncEndCallback(),t.panoIndex===void 0&&t.fov===void 0&&t.latitude===void 0&&t.longitude===void 0?!0:await new Promise((m,c)=>{const l=t.panoIndex!==void 0?t.panoIndex:e.panoIndex;l!==void 0?e.moveToPano(l,Object.assign({duration:r,moveEndCallback:()=>m(!0),moveCancelCallback:()=>c(!1)},t)):c(!1)})),u=t=>{const r=e.state,a=y(r.latitude),m=y(t.latitude),{from:c,to:l}=b(r.longitude,t.longitude,t.rotation||d.Loop),p=r.fov,I=t.fov;return{from:{latitude:a,longitude:c,fov:p},to:{latitude:m,longitude:l,fov:I}}};return{move:o,rotate:async(t,r,a={})=>{n.interruptCallback&&n.interruptCallback(!1),a.asyncStartCallback&&await a.asyncStartCallback(),e.currentMode!==g.Mode.Panorama&&await e.changeMode(g.Mode.Panorama),t.panoIndex!==void 0&&t.panoIndex!==e.panoIndex&&(a.preload&&await e.preloadPano(t.panoIndex),await new Promise((l,p)=>{if(!t.panoIndex){l(!0);return}e.moveToPano(t.panoIndex,{moveEndCallback:()=>l(!0),moveCancelCallback:()=>p(!1)})})),a.asyncEndCallback&&await a.asyncEndCallback();const{from:m,to:c}=u(t);return await new Promise(l=>{const p=({progress:f})=>{const C={};C.longitude=P(m.longitude,c.longitude,f),C.latitude=P(m.latitude,c.latitude,f),C.fov=P(m.fov,c.fov,f),e.setState(C,!0)},I=()=>{l(!0)},S=()=>{l(!1)},_=t.rotateSpeed?Math.ceil(Math.abs(c.longitude-m.longitude)/t.rotateSpeed*1e3):r,h=V(_,L.Linear.None).onUpdate(p).onComplete(I).onDestroy(S);t.rotation===d.Loop&&h.repeat(1/0).yoyo(!0),n.interruptCallback=(f=!0)=>{h.destroy(),n.interruptCallback=void 0,n.timeoutId&&(clearTimeout(n.timeoutId),n.timeoutId=void 0),l(f)},n.timeoutId=setTimeout(()=>{n.interruptCallback&&n.interruptCallback(!0)},r)})}}};function E(){return{width:window.innerWidth,height:window.innerHeight}}function G(){const[e,n]=M.exports.useState(E);return M.exports.useEffect(()=>{const o=()=>n(E());return window.addEventListener("resize",o,!1),()=>window.removeEventListener("resize",o,!1)}),e}const k={PANO_MOVE:{fov:98,panoIndex:1,latitude:-.007769878726327784,longitude:4.614049904222785},CLOCKWISE_ROTATION:{fov:50,latitude:.0340522133938706,longitude:.1257016521296519,rotation:d.Anticlockwise},COUNTERCLOCKWISE_ROTATION:{fov:50,latitude:.0340522133938706,longitude:.1257016521296519,rotation:d.Clockwise},ROUND:{fov:50,latitude:-.0004827098383655415,longitude:1.264471004436043,rotateSpeed:.25,rotation:d.Loop}},H=e=>{const n=R(),o=(i,t=1e4)=>{n.plugins.cameraMovementPlugin.move(i,t)},u=(i,t=1e4)=>{n.plugins.cameraMovementPlugin.rotate(i,t)};return s(D,{children:s(B,{sx:{position:"fixed",top:"10px",right:"10px",backgroundColor:"transparent"},children:F(U,{size:"large","aria-label":"large button group",orientation:"vertical",children:[s(w,{onClick:()=>o(k.PANO_MOVE),children:"\u70B9\u4F4D\u6E38\u8D70"}),s(w,{onClick:()=>u(k.CLOCKWISE_ROTATION),children:"\u987A\u65F6\u9488\u65CB\u8F6C"}),s(w,{onClick:()=>u(k.COUNTERCLOCKWISE_ROTATION),children:"\u9006\u65F6\u9488\u65CB\u8F6C"}),s(w,{onClick:()=>u(k.ROUND,2e4),children:"\u6765\u56DE\u65CB\u8F6C"})]})})})},J=W({onlyRenderIfNeeds:!0,plugins:[[$,"cameraMovementPlugin",{}]]}),Q=()=>{const e=G();return x&&F(J,{initialWork:x,ref:n=>Object.assign(window,{$five:n?.five}),children:[s(z,{...e}),s(H,{})]})};j.render(s(Q,{}),document.querySelector("#app"));
